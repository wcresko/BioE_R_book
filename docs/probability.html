<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Probability – BioEngineering Statistics Computational Tools</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./summary.html" rel="next">
<link href="./Git_GitHub.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./probability.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">BioEngineering Statistics Computational Tools</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">R basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Programming_Basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Programming Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Tidyverse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Git_GitHub.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Git and GitHub</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#different-flavors-of-inferential-statistics" id="toc-different-flavors-of-inferential-statistics" class="nav-link active" data-scroll-target="#different-flavors-of-inferential-statistics"><span class="header-section-number">7.1</span> Different flavors of inferential statistics</a></li>
  <li><a href="#r-python-can-be-used-for-both-flavors" id="toc-r-python-can-be-used-for-both-flavors" class="nav-link" data-scroll-target="#r-python-can-be-used-for-both-flavors"><span class="header-section-number">7.2</span> R (&amp;Python) can be used for both flavors</a></li>
  <li><a href="#what-is-probability" id="toc-what-is-probability" class="nav-link" data-scroll-target="#what-is-probability"><span class="header-section-number">7.3</span> What is probability</a></li>
  <li><a href="#random-variables-probability" id="toc-random-variables-probability" class="nav-link" data-scroll-target="#random-variables-probability"><span class="header-section-number">7.4</span> Random variables &amp; probability</a></li>
  <li><a href="#random-variables-probability-1" id="toc-random-variables-probability-1" class="nav-link" data-scroll-target="#random-variables-probability-1"><span class="header-section-number">7.5</span> Random variables &amp; probability</a></li>
  <li><a href="#bernoulli-distribution" id="toc-bernoulli-distribution" class="nav-link" data-scroll-target="#bernoulli-distribution"><span class="header-section-number">7.6</span> Bernoulli distribution</a></li>
  <li><a href="#bernoulli-distribution-1" id="toc-bernoulli-distribution-1" class="nav-link" data-scroll-target="#bernoulli-distribution-1"><span class="header-section-number">7.7</span> Bernoulli distribution</a></li>
  <li><a href="#probability-rules" id="toc-probability-rules" class="nav-link" data-scroll-target="#probability-rules"><span class="header-section-number">7.8</span> Probability rules</a></li>
  <li><a href="#probability-rules-1" id="toc-probability-rules-1" class="nav-link" data-scroll-target="#probability-rules-1"><span class="header-section-number">7.9</span> Probability rules</a></li>
  <li><a href="#expectation-and-moments-of-distributions" id="toc-expectation-and-moments-of-distributions" class="nav-link" data-scroll-target="#expectation-and-moments-of-distributions"><span class="header-section-number">7.10</span> Expectation and Moments of Distributions</a></li>
  <li><a href="#joint-probability" id="toc-joint-probability" class="nav-link" data-scroll-target="#joint-probability"><span class="header-section-number">7.11</span> Joint probability</a></li>
  <li><a href="#conditional-probability" id="toc-conditional-probability" class="nav-link" data-scroll-target="#conditional-probability"><span class="header-section-number">7.12</span> Conditional probability</a></li>
  <li><a href="#what-is-likelihood-vs.-probability" id="toc-what-is-likelihood-vs.-probability" class="nav-link" data-scroll-target="#what-is-likelihood-vs.-probability"><span class="header-section-number">7.13</span> What is Likelihood vs.&nbsp;Probability?</a></li>
  <li><a href="#a-bayesian-looks-at-estimation" id="toc-a-bayesian-looks-at-estimation" class="nav-link" data-scroll-target="#a-bayesian-looks-at-estimation"><span class="header-section-number">7.14</span> A Bayesian looks at estimation</a></li>
  <li><a href="#who-wants-to-win-a-car" id="toc-who-wants-to-win-a-car" class="nav-link" data-scroll-target="#who-wants-to-win-a-car"><span class="header-section-number">7.15</span> Who wants to win a car?</a></li>
  <li><a href="#izzi-probability" id="toc-izzi-probability" class="nav-link" data-scroll-target="#izzi-probability"><span class="header-section-number">7.16</span> Izzi probability</a></li>
  <li><a href="#discrete-probability" id="toc-discrete-probability" class="nav-link" data-scroll-target="#discrete-probability"><span class="header-section-number">7.17</span> Discrete probability</a>
  <ul class="collapse">
  <li><a href="#relative-frequency" id="toc-relative-frequency" class="nav-link" data-scroll-target="#relative-frequency"><span class="header-section-number">7.17.1</span> Relative frequency</a></li>
  <li><a href="#notation" id="toc-notation" class="nav-link" data-scroll-target="#notation"><span class="header-section-number">7.17.2</span> Notation</a></li>
  <li><a href="#probability-distributions" id="toc-probability-distributions" class="nav-link" data-scroll-target="#probability-distributions"><span class="header-section-number">7.17.3</span> Probability distributions</a></li>
  </ul></li>
  <li><a href="#monte-carlo-simulations-for-categorical-data" id="toc-monte-carlo-simulations-for-categorical-data" class="nav-link" data-scroll-target="#monte-carlo-simulations-for-categorical-data"><span class="header-section-number">7.18</span> Monte Carlo simulations for categorical data</a>
  <ul class="collapse">
  <li><a href="#setting-the-random-seed" id="toc-setting-the-random-seed" class="nav-link" data-scroll-target="#setting-the-random-seed"><span class="header-section-number">7.18.1</span> Setting the random seed</a></li>
  <li><a href="#with-and-without-replacement" id="toc-with-and-without-replacement" class="nav-link" data-scroll-target="#with-and-without-replacement"><span class="header-section-number">7.18.2</span> With and without replacement</a></li>
  </ul></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence"><span class="header-section-number">7.19</span> Independence</a></li>
  <li><a href="#conditional-probabilities" id="toc-conditional-probabilities" class="nav-link" data-scroll-target="#conditional-probabilities"><span class="header-section-number">7.20</span> Conditional probabilities</a></li>
  <li><a href="#addition-and-multiplication-rules" id="toc-addition-and-multiplication-rules" class="nav-link" data-scroll-target="#addition-and-multiplication-rules"><span class="header-section-number">7.21</span> Addition and multiplication rules</a>
  <ul class="collapse">
  <li><a href="#multiplication-rule" id="toc-multiplication-rule" class="nav-link" data-scroll-target="#multiplication-rule"><span class="header-section-number">7.21.1</span> Multiplication rule</a></li>
  <li><a href="#multiplication-rule-under-independence" id="toc-multiplication-rule-under-independence" class="nav-link" data-scroll-target="#multiplication-rule-under-independence"><span class="header-section-number">7.21.2</span> Multiplication rule under independence</a></li>
  <li><a href="#addition-rule" id="toc-addition-rule" class="nav-link" data-scroll-target="#addition-rule"><span class="header-section-number">7.21.3</span> Addition rule</a></li>
  </ul></li>
  <li><a href="#combinations-and-permutations" id="toc-combinations-and-permutations" class="nav-link" data-scroll-target="#combinations-and-permutations"><span class="header-section-number">7.22</span> Combinations and permutations</a>
  <ul class="collapse">
  <li><a href="#monte-carlo-example" id="toc-monte-carlo-example" class="nav-link" data-scroll-target="#monte-carlo-example"><span class="header-section-number">7.22.1</span> Monte Carlo example</a></li>
  </ul></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">7.23</span> Examples</a>
  <ul class="collapse">
  <li><a href="#monty-hall-problem" id="toc-monty-hall-problem" class="nav-link" data-scroll-target="#monty-hall-problem"><span class="header-section-number">7.23.1</span> Monty Hall problem</a></li>
  <li><a href="#birthday-problem" id="toc-birthday-problem" class="nav-link" data-scroll-target="#birthday-problem"><span class="header-section-number">7.23.2</span> Birthday problem</a></li>
  </ul></li>
  <li><a href="#infinity-in-practice" id="toc-infinity-in-practice" class="nav-link" data-scroll-target="#infinity-in-practice"><span class="header-section-number">7.24</span> Infinity in practice</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">7.25</span> Exercises</a></li>
  <li><a href="#continuous-probability" id="toc-continuous-probability" class="nav-link" data-scroll-target="#continuous-probability"><span class="header-section-number">7.26</span> Continuous probability</a></li>
  <li><a href="#theoretical-continuous-distributions" id="toc-theoretical-continuous-distributions" class="nav-link" data-scroll-target="#theoretical-continuous-distributions"><span class="header-section-number">7.27</span> Theoretical continuous distributions</a>
  <ul class="collapse">
  <li><a href="#theoretical-distributions-as-approximations" id="toc-theoretical-distributions-as-approximations" class="nav-link" data-scroll-target="#theoretical-distributions-as-approximations"><span class="header-section-number">7.27.1</span> Theoretical distributions as approximations</a></li>
  <li><a href="#the-probability-density" id="toc-the-probability-density" class="nav-link" data-scroll-target="#the-probability-density"><span class="header-section-number">7.27.2</span> The probability density</a></li>
  </ul></li>
  <li><a href="#monte-carlo-simulations-for-continuous-variables" id="toc-monte-carlo-simulations-for-continuous-variables" class="nav-link" data-scroll-target="#monte-carlo-simulations-for-continuous-variables"><span class="header-section-number">7.28</span> Monte Carlo simulations for continuous variables</a></li>
  <li><a href="#continuous-distributions" id="toc-continuous-distributions" class="nav-link" data-scroll-target="#continuous-distributions"><span class="header-section-number">7.29</span> Continuous distributions</a></li>
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1"><span class="header-section-number">7.30</span> Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="different-flavors-of-inferential-statistics" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="different-flavors-of-inferential-statistics"><span class="header-section-number">7.1</span> Different flavors of inferential statistics</h2>
<p><br></p>
<ul>
<li><strong>Frequentist Statistics</strong>
<ul>
<li>Classical or standard approaches</li>
<li>Null hypothesis testing</li>
<li>Genomic data provides challenges</li>
</ul></li>
</ul>
<p><br></p>
<ul>
<li><strong>Hierarchical Probabilistic Modeling</strong>
<ul>
<li>Maximum Likelihood</li>
<li>Bayesian Analyses</li>
<li>Machine Learning</li>
</ul></li>
</ul>
</section>
<section id="r-python-can-be-used-for-both-flavors" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="r-python-can-be-used-for-both-flavors"><span class="header-section-number">7.2</span> R (&amp;Python) can be used for both flavors</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/prob.021.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Stan® is a platform for statistical modeling computation</li>
<li>Bayesian statistical inference with MCMC</li>
<li>approximate Bayesian inference with variational inference</li>
<li>maximum likelihood estimation with optimization</li>
<li>probability functions &amp; linear algebra</li>
</ul>
</section>
<section id="what-is-probability" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="what-is-probability"><span class="header-section-number">7.3</span> What is probability</h2>
<ul>
<li><strong>Frequency interpretation</strong> <br> <br> “Probabilities are understood as mathematically convenient approximations to long run relative frequencies.” <br> <br></li>
<li><strong>Subjective interpretation</strong> <br> <br> “A probability statement expresses the opinion of some individual regarding how certain an event is to occur.” <br></li>
</ul>
</section>
<section id="random-variables-probability" class="level2 smaller" data-number="7.4">
<h2 class="smaller anchored" data-number="7.4" data-anchor-id="random-variables-probability"><span class="header-section-number">7.4</span> Random variables &amp; probability</h2>
<p><br></p>
<ul>
<li><p><strong>Probability</strong> is the expression of belief in some future outcome</p></li>
<li><p>A <strong>random variable</strong> can take on different values with different probabilities</p></li>
<li><p>The <strong>sample space</strong> of a random variable is the universe of all possible values</p></li>
</ul>
</section>
<section id="random-variables-probability-1" class="level2 smaller" data-number="7.5">
<h2 class="smaller anchored" data-number="7.5" data-anchor-id="random-variables-probability-1"><span class="header-section-number">7.5</span> Random variables &amp; probability</h2>
<p><br></p>
<ul>
<li><p>The <strong>sample space</strong> can be represented by a</p>
<ul>
<li><strong>probability distribution</strong> (discrete)</li>
<li><strong>probability density function</strong> (continuous)</li>
<li>algebra and calculus are used for each respectively</li>
<li>probabilities of a sample space <strong>always sum to 1.0</strong></li>
</ul>
<p><br></p></li>
<li><p>There are many <strong>families</strong> or <strong>forms</strong> of distributions or PDFs</p>
<ul>
<li>depends on the dynamical system they represent</li>
<li>the exact <strong>instantiation of the form</strong> depends on their parameter values</li>
<li>we are often interested in <strong>estimating parameters</strong></li>
</ul></li>
</ul>
</section>
<section id="bernoulli-distribution" class="level2 smaller" data-number="7.6">
<h2 class="smaller anchored" data-number="7.6" data-anchor-id="bernoulli-distribution"><span class="header-section-number">7.6</span> Bernoulli distribution</h2>
<ul>
<li><p>Describes the expected outcome of a single event with probability <code>p</code></p></li>
<li><p>Example of flipping of a <strong>fair</strong> coin once</p></li>
</ul>
<p><br></p>
<p><span class="math display">\[Pr(X=\text{Head}) = \frac{1}{2} = 0.5 = p \]</span></p>
<p><span class="math display">\[Pr(X=\text{Tails}) = \frac{1}{2} = 0.5 = 1 - p \]</span></p>
</section>
<section id="bernoulli-distribution-1" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="bernoulli-distribution-1"><span class="header-section-number">7.7</span> Bernoulli distribution</h2>
<ul>
<li>If the coin isn’t fair then <span class="math inline">\(p \neq 0.5\)</span></li>
<li>However, the probabilities still sum to 1 <br> <br> <span class="math display">\[ p + (1-p) = 1 \]</span> <br> <br></li>
<li>Same is true for other binary possibilities
<ul>
<li>success or failure</li>
<li>yes or no answers</li>
<li>choosing an allele from a population based upon allele frequencies</li>
</ul></li>
</ul>
</section>
<section id="probability-rules" class="level2 flexbox vcenter" data-number="7.8">
<h2 class="flexbox vcenter anchored" data-number="7.8" data-anchor-id="probability-rules"><span class="header-section-number">7.8</span> Probability rules</h2>
<p><br></p>
<ul>
<li>Flip a coin twice</li>
<li>Represent the first flip as ‘X’ and the second flip as ‘Y’</li>
</ul>
<p><br> <br></p>
<p><span class="math display">\[ Pr(\text{X=H and Y=H}) = p*p = p^2 \]</span> <span class="math display">\[ Pr(\text{X=H and Y=T}) = p*p = p^2 \]</span> <span class="math display">\[ Pr(\text{X=T and Y=H}) = p*p = p^2 \]</span> <span class="math display">\[ Pr(\text{X=T and Y=T}) = p*p = p^2 \]</span></p>
</section>
<section id="probability-rules-1" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="probability-rules-1"><span class="header-section-number">7.9</span> Probability rules</h2>
<p><br></p>
<ul>
<li>Probability that the <code>H</code> and <code>T</code> can occur in any order</li>
</ul>
<p><br></p>
<p><span class="math display">\[ \text{Pr(X=H and Y=T) or Pr(X=T and Y=H)} = \]</span> <span class="math display">\[ (p*p) + (p*p) = 2p^{2} \]</span> <br> <br></p>
<ul>
<li>These are the <strong>‘and’</strong> and <strong>‘or’</strong> rules of probability
<ul>
<li>‘and’ means multiply the probabilities</li>
<li>‘or’ means sum the probabilities</li>
<li>most probability distributions can be built up from these simple rules</li>
</ul></li>
</ul>
</section>
<section id="expectation-and-moments-of-distributions" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="expectation-and-moments-of-distributions"><span class="header-section-number">7.10</span> Expectation and Moments of Distributions</h2>
<p><br></p>
<ul>
<li>Distributions have <strong>moments</strong> that can be estimated</li>
<li>1st, 2nd, 3rd and 4th moments of a distribution?</li>
<li>The expectation or mean of a random variable X is:</li>
</ul>
<p><span class="math display">\[E[X] = \sum_{\text{all x}}^{}xP(X=x) = \mu\]</span> <br></p>
<ul>
<li>Often we want to know how dispersed the random variable is around its mean.</li>
<li>One measure of dispersion is the variance</li>
</ul>
<p><span class="math display">\[Var(X) = E[X^2] = \sigma^2\]</span></p>
</section>
<section id="joint-probability" class="level2" data-number="7.11">
<h2 data-number="7.11" class="anchored" data-anchor-id="joint-probability"><span class="header-section-number">7.11</span> Joint probability</h2>
<p><br> <br> <span class="math display">\[Pr(X,Y) = Pr(X) * Pr(Y)\]</span><br>
<br> <br></p>
<ul>
<li>Note that this is true for two <strong>independent</strong> events</li>
<li>However, for two non-independent events we also have to take into account their <strong>covariance</strong></li>
<li>To do this we need <strong>conditional probabilities</strong></li>
</ul>
</section>
<section id="conditional-probability" class="level2" data-number="7.12">
<h2 data-number="7.12" class="anchored" data-anchor-id="conditional-probability"><span class="header-section-number">7.12</span> Conditional probability</h2>
<p><br></p>
<ul>
<li>For two <strong>independent</strong> variables</li>
</ul>
<p><span class="math display">\[Pr(Y|X) = Pr(Y)\text{ and }Pr(X|Y) = Pr(X)\]</span></p>
<p><br></p>
<ul>
<li>For two <strong>non-independent</strong> variables</li>
</ul>
<p><span class="math display">\[Pr(Y|X) \neq Pr(Y)\text{ and }Pr(X|Y) \neq Pr(X)\]</span> <br></p>
<ul>
<li>Variables that are non-independent have a shared variance, which is also known as the <strong>covariance</strong></li>
<li>Covariance standardized to a mean of zero and a unit standard deviation is <strong>correlation</strong></li>
</ul>
</section>
<section id="what-is-likelihood-vs.-probability" class="level2" data-number="7.13">
<h2 data-number="7.13" class="anchored" data-anchor-id="what-is-likelihood-vs.-probability"><span class="header-section-number">7.13</span> What is Likelihood vs.&nbsp;Probability?</h2>
<ul>
<li><p>The <strong>probability</strong> of an event is the proportion of times that the event would occur if we repeated a random trial over and over again under the same conditions.</p></li>
<li><p>The <strong>likelihood</strong> is a conditional probability of a parameter value given a set of data</p></li>
<li><p>The likelihood of a population parameter <strong>equaling a specific value, given the data</strong></p></li>
</ul>
<p><code>L[parameter|data] = Pr[data|parameter]</code></p>
<ul>
<li>This is the <strong>likelihood function</strong> which can have a maximum</li>
</ul>
</section>
<section id="a-bayesian-looks-at-estimation" class="level2" data-number="7.14">
<h2 data-number="7.14" class="anchored" data-anchor-id="a-bayesian-looks-at-estimation"><span class="header-section-number">7.14</span> A Bayesian looks at estimation</h2>
<ul>
<li>A way of quantifying uncertainty of the population parameter, <strong>not our estimate of it</strong>, using prior information about the probability distribution of the parameter.</li>
</ul>
<p><br></p>
<p><span class="math display">\[ P(\theta|d) = \frac{P(d|\theta)P(\theta)}{P(d)}\]</span></p>
<p>where <br></p>
<ul>
<li><span class="math inline">\(P(\theta|d)\)</span> = posterior probability distribution <br></li>
<li><span class="math inline">\(P(d|\theta)\)</span> = likelihood function for <span class="math inline">\(\theta\)</span> <br></li>
<li><span class="math inline">\(P(\theta)\)</span> = prior probability distribution <br></li>
<li><span class="math inline">\(P(d)\)</span> = mean of the likelihood function <br></li>
</ul>
</section>
<section id="who-wants-to-win-a-car" class="level2" data-number="7.15">
<h2 data-number="7.15" class="anchored" data-anchor-id="who-wants-to-win-a-car"><span class="header-section-number">7.15</span> Who wants to win a car?</h2>
<ul>
<li>Pretend that there are three doors, and behind one is a car.</li>
<li>You choose one of the doors, and then Monte Hall opens one of the two remaining doors.</li>
<li>At this point you have the choice of changing doors or staying with your original choice. <br></li>
<li><strong>What should you do?</strong></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/cats/two.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="izzi-probability" class="level2" data-number="7.16">
<h2 data-number="7.16" class="anchored" data-anchor-id="izzi-probability"><span class="header-section-number">7.16</span> Izzi probability</h2>
<p>In games of chance, probability has a very intuitive definition. For instance, we know what it means that the chance of a pair of dice coming up seven is 1 in 6. However, this is not the case in other contexts. Today probability theory is being used much more broadly with the word <em>probability</em> commonly used in everyday language. Google’s auto-complete of “What are the chances of” give us: “having twins”, “rain today”, “getting struck by lightning”, and “getting cancer”. One of the goals of this part of the book is to help us understand how probability is useful to understand and describe real-world events when performing data analysis.</p>
<p>Because knowing how to compute probabilities gives you an edge in games of chance, throughout history many smart individuals, including famous mathematicians such as Cardano, Fermat, and Pascal, spent time and energy thinking through the math of these games. As a result, Probability Theory was born. Probability continues to be highly useful in modern games of chance. For example, in poker, we can compute the probability of winning a hand based on the cards on the table. Also, casinos rely on probability theory to develop games that almost certainly guarantee a profit.</p>
<p>Probability theory is useful in many other contexts and, in particular, in areas that depend on data affected by chance in some way. All of the other chapters in this part build upon probability theory. Knowledge of probability is therefore indispensable for data science.</p>
</section>
<section id="discrete-probability" class="level2" data-number="7.17">
<h2 data-number="7.17" class="anchored" data-anchor-id="discrete-probability"><span class="header-section-number">7.17</span> Discrete probability</h2>
<p>We start by covering some basic principles related to categorical data. The subset of probability is referred to as <em>discrete probability</em>. It will help us understand the probability theory we will later introduce for numeric and continuous data, which is much more common in data science applications. Discrete probability is more useful in card games and therefore we use these as examples.</p>
<section id="relative-frequency" class="level3" data-number="7.17.1">
<h3 data-number="7.17.1" class="anchored" data-anchor-id="relative-frequency"><span class="header-section-number">7.17.1</span> Relative frequency</h3>
<p>The word probability is used in everyday language. Answering questions about probability is often hard, if not impossible. Here we discuss a mathematical definition of <em>probability</em> that does permit us to give precise answers to certain questions.</p>
<p>For example, if I have 2 red beads and 3 blue beads inside an urn<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> (most probability books use this archaic term, so we do too) and I pick one at random, what is the probability of picking a red one? Our intuition tells us that the answer is 2/5 or 40%. A precise definition can be given by noting that there are five possible outcomes of which two satisfy the condition necessary for the event “pick a red bead”. Since each of the five outcomes has the same chance of occurring, we conclude that the probability is .4 for red and .6 for blue.</p>
<p>A more tangible way to think about the probability of an event is as the proportion of times the event occurs when we repeat the experiment an infinite number of times, independently, and under the same conditions.</p>
</section>
<section id="notation" class="level3" data-number="7.17.2">
<h3 data-number="7.17.2" class="anchored" data-anchor-id="notation"><span class="header-section-number">7.17.2</span> Notation</h3>
<p>We use the notation <span class="math inline">\(\mbox{Pr}(A)\)</span> to denote the probability of event <span class="math inline">\(A\)</span> happening. We use the very general term <em>event</em> to refer to things that can happen when something occurs by chance. In our previous example, the event was “picking a red bead”. In a political poll in which we call 100 likely voters at random, an example of an event is “calling 48 Democrats and 52 Republicans”.</p>
<p>In data science applications, we will often deal with continuous variables. These events will often be things like “is this person taller than 6 feet”. In this case, we write events in a more mathematical form: <span class="math inline">\(X \geq 6\)</span>. We will see more of these examples later. Here we focus on categorical data.</p>
</section>
<section id="probability-distributions" class="level3" data-number="7.17.3">
<h3 data-number="7.17.3" class="anchored" data-anchor-id="probability-distributions"><span class="header-section-number">7.17.3</span> Probability distributions</h3>
<p>If we know the relative frequency of the different categories, defining a distribution for categorical outcomes is relatively straightforward. We simply assign a probability to each category. In cases that can be thought of as beads in an urn, for each bead type, their proportion defines the distribution.</p>
<p>If we are randomly calling likely voters from a population that is 44% Democrat, 44% Republican, 10% undecided, and 2% Green Party, these proportions define the probability for each group. The probability distribution is:</p>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td>Pr(picking a Republican)</td>
<td>=</td>
<td>0.44</td>
</tr>
<tr class="even">
<td>Pr(picking a Democrat)</td>
<td>=</td>
<td>0.44</td>
</tr>
<tr class="odd">
<td>Pr(picking an undecided)</td>
<td>=</td>
<td>0.10</td>
</tr>
<tr class="even">
<td>Pr(picking a Green)</td>
<td>=</td>
<td>0.02</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="monte-carlo-simulations-for-categorical-data" class="level2" data-number="7.18">
<h2 data-number="7.18" class="anchored" data-anchor-id="monte-carlo-simulations-for-categorical-data"><span class="header-section-number">7.18</span> Monte Carlo simulations for categorical data</h2>
<p>Computers provide a way to actually perform the simple random experiment described above: pick a bead at random from a bag that contains three blue beads and two red ones. Random number generators permit us to mimic the process of picking at random.</p>
<p>An example is the <code>sample</code> function in R. We demonstrate its use in the code below. First, we use the function <code>rep</code> to generate the urn:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>beads <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">times =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>beads</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "red"  "red"  "blue" "blue" "blue"</code></pre>
</div>
</div>
<p>and then use <code>sample</code> to pick a bead at random:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(beads, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "blue"</code></pre>
</div>
</div>
<p>This line of code produces one random outcome. We want to repeat this experiment an infinite number of times, but it is impossible to repeat forever. Instead, we repeat the experiment a large enough number of times to make the results practically equivalent to repeating forever. <strong>This is an example of a <em>Monte Carlo</em> simulation</strong>.</p>
<p>Much of what mathematical and theoretical statisticians study, which we do not cover in this book, relates to providing rigorous definitions of “practically equivalent” as well as studying how close a large number of experiments gets us to what happens in the limit. Later in this section, we provide a practical approach to deciding what is “large enough”.</p>
<p>To perform our first Monte Carlo simulation, we use the <code>replicate</code> function, which permits us to repeat the same task any number of times. Here, we repeat the random event <span class="math inline">\(B =\)</span> 10,000 times:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>events <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">sample</span>(beads, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now see if our definition actually is in agreement with this Monte Carlo simulation approximation. We can use <code>table</code> to see the distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(events)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>events
blue  red 
6032 3968 </code></pre>
</div>
</div>
<p>and <code>prop.table</code> gives us the proportions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>events
  blue    red 
0.6032 0.3968 </code></pre>
</div>
</div>
<p>The numbers above are the estimated probabilities provided by this Monte Carlo simulation. Statistical theory, not covered here, tells us that as <span class="math inline">\(B\)</span> gets larger, the estimates get closer to 3/5=.6 and 2/5=.4.</p>
<p>Although this is a simple and not very useful example, we will use Monte Carlo simulations to estimate probabilities in cases in which it is harder to compute the exact ones. Before delving into more complex examples, we use simple ones to demonstrate the computing tools available in R.</p>
<section id="setting-the-random-seed" class="level3" data-number="7.18.1">
<h3 data-number="7.18.1" class="anchored" data-anchor-id="setting-the-random-seed"><span class="header-section-number">7.18.1</span> Setting the random seed</h3>
<p>Before we continue, we will briefly explain the following important line of code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1986</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Throughout this book, we use random number generators. This implies that many of the results presented can actually change by chance, which then suggests that a frozen version of the book may show a different result than what you obtain when you try to code as shown in the book. This is actually fine since the results are random and change from time to time. However, if you want to ensure that results are exactly the same every time you run them, you can set R’s random number generation seed to a specific number. Above we set it to 1986. We want to avoid using the same seed everytime. A popular way to pick the seed is the year - month - day. For example, we picked 1986 on December 20, 2018: <span class="math inline">\(2018 - 12 - 20 = 1986\)</span>.</p>
<p>You can learn more about setting the seed by looking at the documentation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>?set.seed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the exercises, we may ask you to set the seed to assure that the results you obtain are exactly what we expect them to be.</p>
</section>
<section id="with-and-without-replacement" class="level3" data-number="7.18.2">
<h3 data-number="7.18.2" class="anchored" data-anchor-id="with-and-without-replacement"><span class="header-section-number">7.18.2</span> With and without replacement</h3>
<p>The function <code>sample</code> has an argument that permits us to pick more than one element from the urn. However, by default, this selection occurs <em>without replacement</em>: after a bead is selected, it is not put back in the bag. Notice what happens when we ask to randomly select five beads:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(beads, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "red"  "blue" "blue" "blue" "red" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(beads, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "red"  "red"  "blue" "blue" "blue"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(beads, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "blue" "red"  "blue" "red"  "blue"</code></pre>
</div>
</div>
<p>This results in rearrangements that always have three blue and two red beads. If we ask that six beads be selected, we get an error:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(beads, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>Error in sample.int(length(x), size, replace, prob) :    cannot take a sample larger than the population when 'replace = FALSE'</code></p>
<p>However, the <code>sample</code> function can be used directly, without the use of <code>replicate</code>, to repeat the same experiment of picking 1 out of the 5 beads, continually, under the same conditions. To do this, we sample <em>with replacement</em>: return the bead back to the urn after selecting it. We can tell <code>sample</code> to do this by changing the <code>replace</code> argument, which defaults to <code>FALSE</code>, to <code>replace = TRUE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>events <span class="ot">&lt;-</span> <span class="fu">sample</span>(beads, B, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(events))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>events
  blue    red 
0.6017 0.3983 </code></pre>
</div>
</div>
<p>Not surprisingly, we get results very similar to those previously obtained with <code>replicate</code>.</p>
</section>
</section>
<section id="independence" class="level2" data-number="7.19">
<h2 data-number="7.19" class="anchored" data-anchor-id="independence"><span class="header-section-number">7.19</span> Independence</h2>
<p>We say two events are independent if the outcome of one does not affect the other. The classic example is coin tosses. Every time we toss a fair coin, the probability of seeing heads is 1/2 regardless of what previous tosses have revealed. The same is true when we pick beads from an urn with replacement. In the example above, the probability of red is 0.40 regardless of previous draws.</p>
<p>Many examples of events that are not independent come from card games. When we deal the first card, the probability of getting a King is 1/13 since there are thirteen possibilities: Ace, Deuce, Three, <span class="math inline">\(\dots\)</span>, Ten, Jack, Queen, King, and Ace. Now if we deal a King for the first card, and don’t replace it into the deck, the probabilities of a second card being a King is less because there are only three Kings left: the probability is 3 out of 51. These events are therefore <strong>not independent</strong>: the first outcome affected the next one.</p>
<p>To see an extreme case of non-independent events, consider our example of drawing five beads at random <strong>without</strong> replacement:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(beads, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you have to guess the color of the first bead, you will predict blue since blue has a 60% chance. But if I show you the result of the last four outcomes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "blue" "blue" "blue" "red" </code></pre>
</div>
</div>
<p>would you still guess blue? Of course not. Now you know that the probability of red is 1 since the only bead left is red. The events are not independent, so the probabilities change.</p>
</section>
<section id="conditional-probabilities" class="level2" data-number="7.20">
<h2 data-number="7.20" class="anchored" data-anchor-id="conditional-probabilities"><span class="header-section-number">7.20</span> Conditional probabilities</h2>
<p>When events are not independent, <em>conditional probabilities</em> are useful. We already saw an example of a conditional probability: we computed the probability that a second dealt card is a King given that the first was a King. In probability, we use the following notation:</p>
<p><span class="math display">\[
\mbox{Pr}(\mbox{Card 2 is a king} \mid \mbox{Card 1 is a king}) = 3/51
\]</span></p>
<p>We use the <span class="math inline">\(\mid\)</span> as shorthand for “given that” or “conditional on”.</p>
<p>When two events, say <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, are independent, we have:</p>
<p><span class="math display">\[
\mbox{Pr}(A \mid B) = \mbox{Pr}(A)
\]</span></p>
<p>This is the mathematical way of saying: the fact that <span class="math inline">\(B\)</span> happened does not affect the probability of <span class="math inline">\(A\)</span> happening. In fact, this can be considered the mathematical definition of independence.</p>
</section>
<section id="addition-and-multiplication-rules" class="level2" data-number="7.21">
<h2 data-number="7.21" class="anchored" data-anchor-id="addition-and-multiplication-rules"><span class="header-section-number">7.21</span> Addition and multiplication rules</h2>
<section id="multiplication-rule" class="level3" data-number="7.21.1">
<h3 data-number="7.21.1" class="anchored" data-anchor-id="multiplication-rule"><span class="header-section-number">7.21.1</span> Multiplication rule</h3>
<p>If we want to know the probability of two events, say <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, occurring, we can use the multiplication rule:</p>
<p><span class="math display">\[
\mbox{Pr}(A \mbox{ and } B) = \mbox{Pr}(A)\mbox{Pr}(B \mid A)
\]</span> Let’s use Blackjack as an example. In Blackjack, you are assigned two random cards. After you see what you have, you can ask for more. The goal is to get closer to 21 than the dealer, without going over. Face cards are worth 10 points and Aces are worth 11 or 1 (you choose).</p>
<p>So, in a Blackjack game, to calculate the chances of getting a 21 by drawing an Ace and then a face card, we compute the probability of the first being an Ace and multiply by the probability of drawing a face card or a 10 given that the first was an Ace: <span class="math inline">\(1/13 \times 16/51 \approx 0.025\)</span></p>
<p>The multiplication rule also applies to more than two events. We can use induction to expand for more events:</p>
<p><span class="math display">\[
\mbox{Pr}(A \mbox{ and } B \mbox{ and } C) = \mbox{Pr}(A)\mbox{Pr}(B \mid A)\mbox{Pr}(C \mid A \mbox{ and } B)
\]</span></p>
</section>
<section id="multiplication-rule-under-independence" class="level3" data-number="7.21.2">
<h3 data-number="7.21.2" class="anchored" data-anchor-id="multiplication-rule-under-independence"><span class="header-section-number">7.21.2</span> Multiplication rule under independence</h3>
<p>When we have independent events, then the multiplication rule becomes simpler:</p>
<p><span class="math display">\[
\mbox{Pr}(A \mbox{ and } B \mbox{ and } C) = \mbox{Pr}(A)\mbox{Pr}(B)\mbox{Pr}(C)
\]</span></p>
<p>But we have to be very careful before using this since assuming independence can result in very different and incorrect probability calculations when we don’t actually have independence.</p>
<p>As an example, imagine a court case in which the suspect was described as having a mustache and a beard. The defendant has a mustache and a beard and the prosecution brings in an “expert” to testify that 1/10 men have beards and 1/5 have mustaches, so using the multiplication rule we conclude that only <span class="math inline">\(1/10 \times 1/5\)</span> or 0.02 have both.</p>
<p>But to multiply like this we need to assume independence! Say the conditional probability of a man having a mustache conditional on him having a beard is .95. So the correct calculation probability is much higher: <span class="math inline">\(1/10 \times 95/100 = 0.095\)</span>.</p>
<p>The multiplication rule also gives us a general formula for computing conditional probabilities:</p>
<p><span class="math display">\[
\mbox{Pr}(B \mid A) = \frac{\mbox{Pr}(A \mbox{ and } B)}{ \mbox{Pr}(A)}
\]</span></p>
<p>To illustrate how we use these formulas and concepts in practice, we will use several examples related to card games.</p>
</section>
<section id="addition-rule" class="level3" data-number="7.21.3">
<h3 data-number="7.21.3" class="anchored" data-anchor-id="addition-rule"><span class="header-section-number">7.21.3</span> Addition rule</h3>
<p>The addition rule tells us that:</p>
<p><span class="math display">\[
\mbox{Pr}(A \mbox{ or } B) = \mbox{Pr}(A) + \mbox{Pr}(B) - \mbox{Pr}(A \mbox{ and } B)
\]</span></p>
<p>This rule is intuitive: think of a Venn diagram. If we simply add the probabilities, we count the intersection twice so we need to substract one instance.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="probability_files/figure-html/venn-diagram-addition-rule-1.png" class="img-fluid figure-img" style="width:35.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="combinations-and-permutations" class="level2" data-number="7.22">
<h2 data-number="7.22" class="anchored" data-anchor-id="combinations-and-permutations"><span class="header-section-number">7.22</span> Combinations and permutations</h2>
<p>In our very first example, we imagined an urn with five beads. As a reminder, to compute the probability distribution of one draw, we simply listed out all the possibilities. There were 5 and so then, for each event, we counted how many of these possibilities were associated with the event. The resulting probability of choosing a blue bead is 3/5 because out of the five possible outcomes, three were blue.</p>
<p>For more complicated cases, the computations are not as straightforward. For instance, what is the probability that if I draw five cards without replacement, I get all cards of the same suit, what is known as a “flush” in poker? In a discrete probability course you learn theory on how to make these computations. Here we focus on how to use R code to compute the answers.</p>
<p>First, let’s construct a deck of cards. For this, we will use the <code>expand.grid</code> and <code>paste</code> functions. We use <code>paste</code> to create strings by joining smaller strings. To do this, we take the number and suit of a card and create the card name like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>number <span class="ot">&lt;-</span> <span class="st">"Three"</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>suit <span class="ot">&lt;-</span> <span class="st">"Hearts"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(number, suit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Three Hearts"</code></pre>
</div>
</div>
<p><code>paste</code> also works on pairs of vectors performing the operation element-wise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>], <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a 1" "b 2" "c 3" "d 4" "e 5"</code></pre>
</div>
</div>
<p>The function <code>expand.grid</code> gives us all the combinations of entries of two vectors. For example, if you have blue and black pants and white, grey, and plaid shirts, all your combinations are:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expand.grid</span>(<span class="at">pants =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"black"</span>), <span class="at">shirt =</span> <span class="fu">c</span>(<span class="st">"white"</span>, <span class="st">"grey"</span>, <span class="st">"plaid"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  pants shirt
1  blue white
2 black white
3  blue  grey
4 black  grey
5  blue plaid
6 black plaid</code></pre>
</div>
</div>
<p>Here is how we generate a deck of cards:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>suits <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Diamonds"</span>, <span class="st">"Clubs"</span>, <span class="st">"Hearts"</span>, <span class="st">"Spades"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ace"</span>, <span class="st">"Deuce"</span>, <span class="st">"Three"</span>, <span class="st">"Four"</span>, <span class="st">"Five"</span>, <span class="st">"Six"</span>, <span class="st">"Seven"</span>, </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Eight"</span>, <span class="st">"Nine"</span>, <span class="st">"Ten"</span>, <span class="st">"Jack"</span>, <span class="st">"Queen"</span>, <span class="st">"King"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>deck <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">number=</span>numbers, <span class="at">suit=</span>suits)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>deck <span class="ot">&lt;-</span> <span class="fu">paste</span>(deck<span class="sc">$</span>number, deck<span class="sc">$</span>suit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With the deck constructed, we can double check that the probability of a King in the first card is 1/13 by computing the proportion of possible outcomes that satisfy our condition:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>kings <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"King"</span>, suits)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(deck <span class="sc">%in%</span> kings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07692308</code></pre>
</div>
</div>
<p>Now, how about the conditional probability of the second card being a King given that the first was a King? Earlier, we deduced that if one King is already out of the deck and there are 51 left, then this probability is 3/51. Let’s confirm by listing out all possible outcomes.</p>
<p>To do this, we can use the <code>permutations</code> function from the <strong>gtools</strong> package. For any list of size <code>n</code>, this function computes all the different combinations we can get when we select <code>r</code> items. Here are all the ways we can choose two numbers from a list consisting of <code>1,2,3</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtools)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">permutations</span>(<span class="dv">3</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    2
[2,]    1    3
[3,]    2    1
[4,]    2    3
[5,]    3    1
[6,]    3    2</code></pre>
</div>
</div>
<p>Notice that the order matters here: 3,1 is different than 1,3. Also, note that (1,1), (2,2), and (3,3) do not appear because once we pick a number, it can’t appear again.</p>
<p>Optionally, we can add a vector. If you want to see five random seven digit phone numbers out of all possible phone numbers (without repeats), you can type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>all_phone_numbers <span class="ot">&lt;-</span> <span class="fu">permutations</span>(<span class="dv">10</span>, <span class="dv">7</span>, <span class="at">v =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(all_phone_numbers)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(n, <span class="dv">5</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>all_phone_numbers[index,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6] [,7]
[1,]    1    3    8    0    6    7    5
[2,]    2    9    1    6    4    8    0
[3,]    5    1    6    0    9    8    2
[4,]    7    4    6    0    2    8    1
[5,]    4    6    5    9    2    8    0</code></pre>
</div>
</div>
<p>Instead of using the numbers 1 through 10, the default, it uses what we provided through <code>v</code>: the digits 0 through 9.</p>
<p>To compute all possible ways we can choose two cards when the order matters, we type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>hands <span class="ot">&lt;-</span> <span class="fu">permutations</span>(<span class="dv">52</span>, <span class="dv">2</span>, <span class="at">v =</span> deck)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is a matrix with two columns and 2652 rows. With a matrix we can get the first and second cards like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>first_card <span class="ot">&lt;-</span> hands[,<span class="dv">1</span>]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>second_card <span class="ot">&lt;-</span> hands[,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now the cases for which the first hand was a King can be computed like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>kings <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"King"</span>, suits)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(first_card <span class="sc">%in%</span> kings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 204</code></pre>
</div>
</div>
<p>To get the conditional probability, we compute what fraction of these have a King in the second card:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(first_card<span class="sc">%in%</span>kings <span class="sc">&amp;</span> second_card<span class="sc">%in%</span>kings) <span class="sc">/</span> <span class="fu">sum</span>(first_card<span class="sc">%in%</span>kings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05882353</code></pre>
</div>
</div>
<p>which is exactly 3/51, as we had already deduced. Notice that the code above is equivalent to:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(first_card<span class="sc">%in%</span>kings <span class="sc">&amp;</span> second_card<span class="sc">%in%</span>kings) <span class="sc">/</span> <span class="fu">mean</span>(first_card<span class="sc">%in%</span>kings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05882353</code></pre>
</div>
</div>
<p>which uses <code>mean</code> instead of <code>sum</code> and is an R version of:</p>
<p><span class="math display">\[
\frac{\mbox{Pr}(A \mbox{ and } B)}{ \mbox{Pr}(A)}
\]</span></p>
<p>How about if the order doesn’t matter? For example, in Blackjack if you get an Ace and a face card in the first draw, it is called a <em>Natural 21</em> and you win automatically. If we wanted to compute the probability of this happening, we would enumerate the <em>combinations</em>, not the permutations, since the order does not matter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combinations</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    2
[2,]    1    3
[3,]    2    3</code></pre>
</div>
</div>
<p>In the second line, the outcome does not include (2,1) because (1,2) already was enumerated. The same applies to (3,1) and (3,2).</p>
<p>So to compute the probability of a <em>Natural 21</em> in Blackjack, we can do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>aces <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Ace"</span>, suits)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>facecard <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"King"</span>, <span class="st">"Queen"</span>, <span class="st">"Jack"</span>, <span class="st">"Ten"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>facecard <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">number =</span> facecard, <span class="at">suit =</span> suits)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>facecard <span class="ot">&lt;-</span> <span class="fu">paste</span>(facecard<span class="sc">$</span>number, facecard<span class="sc">$</span>suit)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>hands <span class="ot">&lt;-</span> <span class="fu">combinations</span>(<span class="dv">52</span>, <span class="dv">2</span>, <span class="at">v =</span> deck)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(hands[,<span class="dv">1</span>] <span class="sc">%in%</span> aces <span class="sc">&amp;</span> hands[,<span class="dv">2</span>] <span class="sc">%in%</span> facecard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04826546</code></pre>
</div>
</div>
<p>In the last line, we assume the Ace comes first. This is only because we know the way <code>combination</code> enumerates possibilities and it will list this case first. But to be safe, we could have written this and produced the same answer:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((hands[,<span class="dv">1</span>] <span class="sc">%in%</span> aces <span class="sc">&amp;</span> hands[,<span class="dv">2</span>] <span class="sc">%in%</span> facecard) <span class="sc">|</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>       (hands[,<span class="dv">2</span>] <span class="sc">%in%</span> aces <span class="sc">&amp;</span> hands[,<span class="dv">1</span>] <span class="sc">%in%</span> facecard))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04826546</code></pre>
</div>
</div>
<section id="monte-carlo-example" class="level3" data-number="7.22.1">
<h3 data-number="7.22.1" class="anchored" data-anchor-id="monte-carlo-example"><span class="header-section-number">7.22.1</span> Monte Carlo example</h3>
<p>Instead of using <code>combinations</code> to deduce the exact probability of a Natural 21, we can use a Monte Carlo to estimate this probability. In this case, we draw two cards over and over and keep track of how many 21s we get. We can use the function sample to draw two cards without replacements:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>hand <span class="ot">&lt;-</span> <span class="fu">sample</span>(deck, <span class="dv">2</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>hand</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Queen Clubs"  "Seven Spades"</code></pre>
</div>
</div>
<p>And then check if one card is an Ace and the other a face card or a 10. Going forward, we include 10 when we say <em>face card</em>. Now we need to check both possibilities:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(hands[<span class="dv">1</span>] <span class="sc">%in%</span> aces <span class="sc">&amp;</span> hands[<span class="dv">2</span>] <span class="sc">%in%</span> facecard) <span class="sc">|</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  (hands[<span class="dv">2</span>] <span class="sc">%in%</span> aces <span class="sc">&amp;</span> hands[<span class="dv">1</span>] <span class="sc">%in%</span> facecard)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>If we repeat this 10,000 times, we get a very good approximation of the probability of a Natural 21.</p>
<p>Let’s start by writing a function that draws a hand and returns TRUE if we get a 21. The function does not need any arguments because it uses objects defined in the global environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>blackjack <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>   hand <span class="ot">&lt;-</span> <span class="fu">sample</span>(deck, <span class="dv">2</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  (hand[<span class="dv">1</span>] <span class="sc">%in%</span> aces <span class="sc">&amp;</span> hand[<span class="dv">2</span>] <span class="sc">%in%</span> facecard) <span class="sc">|</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    (hand[<span class="dv">2</span>] <span class="sc">%in%</span> aces <span class="sc">&amp;</span> hand[<span class="dv">1</span>] <span class="sc">%in%</span> facecard)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we do have to check both possibilities: Ace first or Ace second because we are not using the <code>combinations</code> function. The function returns <code>TRUE</code> if we get a 21 and <code>FALSE</code> otherwise:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">blackjack</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Now we can play this game, say, 10,000 times:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">blackjack</span>())</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0475</code></pre>
</div>
</div>
</section>
</section>
<section id="examples" class="level2" data-number="7.23">
<h2 data-number="7.23" class="anchored" data-anchor-id="examples"><span class="header-section-number">7.23</span> Examples</h2>
<p>In this section, we describe two discrete probability popular examples: the Monty Hall problem and the birthday problem. We use R to help illustrate the mathematical concepts.</p>
<section id="monty-hall-problem" class="level3" data-number="7.23.1">
<h3 data-number="7.23.1" class="anchored" data-anchor-id="monty-hall-problem"><span class="header-section-number">7.23.1</span> Monty Hall problem</h3>
<p>In the 1970s, there was a game show called “Let’s Make a Deal” and Monty Hall was the host. At some point in the game, contestants were asked to pick one of three doors. Behind one door there was a prize. The other doors had a goat behind them to show the contestant they had lost. After the contestant picked a door, before revealing whether the chosen door contained a prize, Monty Hall would open one of the two remaining doors and show the contestant there was no prize behind that door. Then he would ask “Do you want to switch doors?” What would you do?</p>
<p>We can use probability to show that if you stick with the original door choice, your chances of winning a prize remain 1 in 3. However, if you switch to the other door, your chances of winning double to 2 in 3! This seems counterintuitive. Many people incorrectly think both chances are 1 in 2 since you are choosing between 2 options. You can watch a detailed mathematical explanation on Khan Academy<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> or read one on Wikipedia<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Below we use a Monte Carlo simulation to see which strategy is better. Note that this code is written longer than it should be for pedagogical purposes.</p>
<p>Let’s start with the stick strategy:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>monty_hall <span class="ot">&lt;-</span> <span class="cf">function</span>(strategy){</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  doors <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  prize <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"car"</span>, <span class="st">"goat"</span>, <span class="st">"goat"</span>))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  prize_door <span class="ot">&lt;-</span> doors[prize <span class="sc">==</span> <span class="st">"car"</span>]</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  my_pick  <span class="ot">&lt;-</span> <span class="fu">sample</span>(doors, <span class="dv">1</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  show <span class="ot">&lt;-</span> <span class="fu">sample</span>(doors[<span class="sc">!</span>doors <span class="sc">%in%</span> <span class="fu">c</span>(my_pick, prize_door)],<span class="dv">1</span>)</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  stick <span class="ot">&lt;-</span> my_pick</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  stick <span class="sc">==</span> prize_door</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">switch</span> <span class="ot">&lt;-</span> doors[<span class="sc">!</span>doors<span class="sc">%in%</span><span class="fu">c</span>(my_pick, show)]</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  choice <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(strategy <span class="sc">==</span> <span class="st">"stick"</span>, stick, <span class="cf">switch</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  choice <span class="sc">==</span> prize_door</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>stick <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">monty_hall</span>(<span class="st">"stick"</span>))</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(stick)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3416</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">switch</span> <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">monty_hall</span>(<span class="st">"switch"</span>))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="cf">switch</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6682</code></pre>
</div>
</div>
<p>As we write the code, we note that the lines starting with <code>my_pick</code> and <code>show</code> have no influence on the last logical operation when we stick to our original choice anyway. From this we should realize that the chance is 1 in 3, what we began with. When we switch, the Monte Carlo estimate confirms the 2/3 calculation. This helps us gain some insight by showing that we are removing a door, <code>show</code>, that is definitely not a winner from our choices. We also see that unless we get it right when we first pick, you win: 1 - 1/3 = 2/3.</p>
</section>
<section id="birthday-problem" class="level3" data-number="7.23.2">
<h3 data-number="7.23.2" class="anchored" data-anchor-id="birthday-problem"><span class="header-section-number">7.23.2</span> Birthday problem</h3>
<p>Suppose you are in a classroom with 50 people. If we assume this is a randomly selected group of 50 people, what is the chance that at least two people have the same birthday? Although it is somewhat advanced, we can deduce this mathematically. We will do this later. Here we use a Monte Carlo simulation. For simplicity, we assume nobody was born on February 29. This actually doesn’t change the answer much.</p>
<p>First, note that birthdays can be represented as numbers between 1 and 365, so a sample of 50 birthdays can be obtained like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>bdays <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To check if in this particular set of 50 people we have at least two with the same birthday, we can use the function <code>duplicated</code>, which returns <code>TRUE</code> whenever an element of a vector is a duplicate. Here is an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duplicated</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE</code></pre>
</div>
</div>
<p>The second time 1 and 3 appear, we get a <code>TRUE</code>. So to check if two birthdays were the same, we simply use the <code>any</code> and <code>duplicated</code> functions like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(bdays))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>In this case, we see that it did happen. At least two people had the same birthday.</p>
<p>To estimate the probability of a shared birthday in the group, we repeat this experiment by sampling sets of 50 birthdays over and over:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>same_birthday <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  bdays <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">365</span>, n, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">any</span>(<span class="fu">duplicated</span>(bdays))</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">same_birthday</span>(<span class="dv">50</span>))</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9691</code></pre>
</div>
</div>
<p>Were you expecting the probability to be this high?</p>
<p>People tend to underestimate these probabilities. To get an intuition as to why it is so high, think about what happens when the group size is close to 365. At this stage, we run out of days and the probability is one.</p>
<p>Say we want to use this knowledge to bet with friends about two people having the same birthday in a group of people. When are the chances larger than 50%? Larger than 75%?</p>
<p>Let’s create a look-up table. We can quickly create a function to compute this for any group size:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>compute_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">B=</span><span class="dv">10000</span>){</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">same_birthday</span>(n))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(results)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using the function <code>sapply</code>, we can perform element-wise operations on any function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">60</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n, compute_prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now make a plot of the estimated probabilities of two people having the same birthday in a group of size <span class="math inline">\(n\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n, compute_prob)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(n, prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="probability_files/figure-html/birthday-problem-mc-probabilities-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s compute the exact probabilities rather than use Monte Carlo approximations. Not only do we get the exact answer using math, but the computations are much faster since we don’t have to generate experiments.</p>
<p>To make the math simpler, instead of computing the probability of it happening, we will compute the probability of it not happening. For this, we use the multiplication rule.</p>
<p>Let’s start with the first person. The probability that person 1 has a unique birthday is 1. The probability that person 2 has a unique birthday, given that person 1 already took one, is 364/365. Then, given that the first two people have unique birthdays, person 3 is left with 363 days to choose from. We continue this way and find the chances of all 50 people having a unique birthday is:</p>
<p><span class="math display">\[
1 \times \frac{364}{365}\times\frac{363}{365} \dots \frac{365-n + 1}{365}
\]</span></p>
<p>We can write a function that does this for any number:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>exact_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  prob_unique <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">365</span>,<span class="dv">365</span><span class="sc">-</span>n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">365</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">prod</span>( prob_unique)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>eprob <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n, exact_prob)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(n, prob) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(n, eprob), <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="probability_files/figure-html/birthday-problem-exact-probabilities-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows that the Monte Carlo simulation provided a very good estimate of the exact probability. Had it not been possible to compute the exact probabilities, we would have still been able to accurately estimate the probabilities.</p>
</section>
</section>
<section id="infinity-in-practice" class="level2" data-number="7.24">
<h2 data-number="7.24" class="anchored" data-anchor-id="infinity-in-practice"><span class="header-section-number">7.24</span> Infinity in practice</h2>
<p>The theory described here requires repeating experiments over and over forever. In practice we can’t do this. In the examples above, we used <span class="math inline">\(B=10,000\)</span> Monte Carlo experiments and it turned out that this provided accurate estimates. The larger this number, the more accurate the estimate becomes until the approximaton is so good that your computer can’t tell the difference. But in more complex calculations, 10,000 may not be nearly enough. Also, for some calculations, 10,000 experiments might not be computationally feasible. In practice, we won’t know what the answer is, so we won’t know if our Monte Carlo estimate is accurate. We know that the larger <span class="math inline">\(B\)</span>, the better the approximation. But how big do we need it to be? This is actually a challenging question and answering it often requires advanced theoretical statistics training.</p>
<p>One practical approach we will describe here is to check for the stability of the estimate. The following is an example with the birthday problem for a group of 25 people.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">len =</span> <span class="dv">100</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>compute_prob <span class="ot">&lt;-</span> <span class="cf">function</span>(B, <span class="at">n=</span><span class="dv">25</span>){</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  same_day <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, <span class="fu">same_birthday</span>(n))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(same_day)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">sapply</span>(B, compute_prob)</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(<span class="fu">log10</span>(B), prob, <span class="at">geom =</span> <span class="st">"line"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="probability_files/figure-html/monte-carlo-convergence-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this plot, we can see that the values start to stabilize (that is, they vary less than .01) around 1000. Note that the exact probability, which we know in this case, is 0.5686997.</p>
</section>
<section id="exercises" class="level2" data-number="7.25">
<h2 data-number="7.25" class="anchored" data-anchor-id="exercises"><span class="header-section-number">7.25</span> Exercises</h2>
<p>1. One ball will be drawn at random from a box containing: 3 cyan balls, 5 magenta balls, and 7 yellow balls. What is the probability that the ball will be cyan?</p>
<p>2. What is the probability that the ball will not be cyan?</p>
<p>3. Instead of taking just one draw, consider taking two draws. You take the second draw without returning the first draw to the box. We call this sampling <strong>without</strong> replacement. What is the probability that the first draw is cyan and that the second draw is not cyan?</p>
<p>4. Now repeat the experiment, but this time, after taking the first draw and recording the color, return it to the box and shake the box. We call this sampling <strong>with</strong> replacement. What is the probability that the first draw is cyan and that the second draw is not cyan?</p>
<p>5. Two events <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are independent if <span class="math inline">\(\mbox{Pr}(A \mbox{ and } B) = \mbox{Pr}(A) P(B)\)</span>. Under which situation are the draws independent?</p>
<ol type="a">
<li>You don’t replace the draw.</li>
<li>You replace the draw.</li>
<li>Neither</li>
<li>Both</li>
</ol>
<p>6. Say you’ve drawn 5 balls from the box, with replacement, and all have been yellow. What is the probability that the next one is yellow?</p>
<p>7. If you roll a 6-sided die six times, what is the probability of not seeing a 6?</p>
<p>8. Two teams, say the Celtics and the Cavs, are playing a seven game series. The Cavs are a better team and have a 60% chance of winning each game. What is the probability that the Celtics win <strong>at least</strong> one game?</p>
<p>9. Create a Monte Carlo simulation to confirm your answer to the previous problem. Use <code>B &lt;- 10000</code> simulations. Hint: use the following code to generate the results of the first four games:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>celtic_wins <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dv">4</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The Celtics must win one of these 4 games.</p>
<p>10. Two teams, say the Cavs and the Warriors, are playing a seven game championship series. The first to win four games, therefore, wins the series. The teams are equally good so they each have a 50-50 chance of winning each game. If the Cavs lose the first game, what is the probability that they win the series?</p>
<p>11. Confirm the results of the previous question with a Monte Carlo simulation.</p>
<p>12. Two teams, <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, are playing a seven game series. Team <span class="math inline">\(A\)</span> is better than team <span class="math inline">\(B\)</span> and has a <span class="math inline">\(p&gt;0.5\)</span> chance of winning each game. Given a value <span class="math inline">\(p\)</span>, the probability of winning the series for the underdog team <span class="math inline">\(B\)</span> can be computed with the following function based on a Monte Carlo simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>prob_win <span class="ot">&lt;-</span> <span class="cf">function</span>(p){</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>    b_win <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), <span class="dv">7</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p, p))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(b_win)<span class="sc">&gt;=</span><span class="dv">4</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(result)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use the function <code>sapply</code> to compute the probability, call it <code>Pr</code>, of winning for <code>p &lt;- seq(0.5, 0.95, 0.025)</code>. Then plot the result.</p>
<p>13. Repeat the exercise above, but now keep the probability fixed at <code>p &lt;- 0.75</code> and compute the probability for different series lengths: best of 1 game, 3 games, 5 games,… Specifically, <code>N &lt;- seq(1, 25, 2)</code>. Hint: use this function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>prob_win <span class="ot">&lt;-</span> <span class="cf">function</span>(N, <span class="at">p=</span><span class="fl">0.75</span>){</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    b_win <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>), N, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>p, p))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(b_win)<span class="sc">&gt;=</span>(N<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(result)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="continuous-probability" class="level2" data-number="7.26">
<h2 data-number="7.26" class="anchored" data-anchor-id="continuous-probability"><span class="header-section-number">7.26</span> Continuous probability</h2>
<p>In Section @ref(cdf-intro), we explained why when summarizing a list of numeric values, such as heights, it is not useful to construct a distribution that defines a proportion to each possible outcome. For example, if we measure every single person in a very large population of size <span class="math inline">\(n\)</span> with extremely high precision, since no two people are exactly the same height, we need to assign the proportion <span class="math inline">\(1/n\)</span> to each observed value and attain no useful summary at all. Similarly, when defining probability distributions, it is not useful to assign a very small probability to every single height.</p>
<p>Just as when using distributions to summarize numeric data, it is much more practical to define a function that operates on intervals rather than single values. The standard way of doing this is using the <em>cumulative distribution function</em> (CDF).</p>
<p>We described empirical cumulative distribution function (eCDF) in Section @ref(cdf-intro) as a basic summary of a list of numeric values. As an example, we earlier defined the height distribution for adult male students. Here, we define the vector <span class="math inline">\(x\)</span> to contain these heights:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dslabs)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(heights)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> heights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">"Male"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We defined the empirical distribution function as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">mean</span>(x<span class="sc">&lt;=</span>a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>which, for any value <code>a</code>, gives the proportion of values in the list <code>x</code> that are smaller or equal than <code>a</code>.</p>
<p>Keep in mind that we have not yet introduced probability in the context of CDFs. Let’s do this by asking the following: if I pick one of the male students at random, what is the chance that he is taller than 70.5 inches? Because every student has the same chance of being picked, the answer to this is equivalent to the proportion of students that are taller than 70.5 inches. Using the CDF we obtain an answer by typing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">F</span>(<span class="dv">70</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3768473</code></pre>
</div>
</div>
<p>Once a CDF is defined, we can use this to compute the probability of any subset. For instance, the probability of a student being between height <code>a</code> and height <code>b</code> is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(b)<span class="sc">-</span><span class="fu">F</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because we can compute the probability for any possible event this way, the cumulative probability function defines the probability distribution for picking a height at random from our vector of heights <code>x</code>.</p>
</section>
<section id="theoretical-continuous-distributions" class="level2" data-number="7.27">
<h2 data-number="7.27" class="anchored" data-anchor-id="theoretical-continuous-distributions"><span class="header-section-number">7.27</span> Theoretical continuous distributions</h2>
<p>In Section @ref(normal-distribution) we introduced the normal distribution as a useful approximation to many naturally occurring distributions, including that of height. The cumulative distribution for the normal distribution is defined by a mathematical formula which in R can be obtained with the function <code>pnorm</code>. We say that a random quantity is normally distributed with average <code>m</code> and standard deviation <code>s</code> if its probability distribution is defined by:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(a) <span class="ot">=</span> <span class="fu">pnorm</span>(a, m, s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is useful because if we are willing to use the normal approximation for, say, height, we don’t need the entire dataset to answer questions such as: what is the probability that a randomly selected student is taller then 70 inches? We just need the average height and standard deviation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">70.5</span>, m, s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.371369</code></pre>
</div>
</div>
<section id="theoretical-distributions-as-approximations" class="level3" data-number="7.27.1">
<h3 data-number="7.27.1" class="anchored" data-anchor-id="theoretical-distributions-as-approximations"><span class="header-section-number">7.27.1</span> Theoretical distributions as approximations</h3>
<p>The normal distribution is derived mathematically: we do not need data to define it. For practicing data scientists, almost everything we do involves data. Data is always, technically speaking, discrete. For example, we could consider our height data categorical with each specific height a unique category. The probability distribution is defined by the proportion of students reporting each height. Here is a plot of that probability distribution:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="probability_files/figure-html/plot-of-height-frequencies-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While most students rounded up their heights to the nearest inch, others reported values with more precision. One student reported his height to be 69.6850393700787, which is 177 centimeters. The probability assigned to this height is 0.0012315 or 1 in 812. The probability for 70 inches is much higher at 0.1059113, but does it really make sense to think of the probability of being exactly 70 inches as being different than 69.6850393700787? Clearly it is much more useful for data analytic purposes to treat this outcome as a continuous numeric variable, keeping in mind that very few people, or perhaps none, are exactly 70 inches, and that the reason we get more values at 70 is because people round to the nearest inch.</p>
<p>With continuous distributions, the probability of a singular value is not even defined. For example, it does not make sense to ask what is the probability that a normally distributed value is 70. Instead, we define probabilities for intervals. We thus could ask what is the probability that someone is between 69.5 and 70.5.</p>
<p>In cases like height, in which the data is rounded, the normal approximation is particularly useful if we deal with intervals that include exactly one round number. For example, the normal distribution is useful for approximating the proportion of students reporting values in intervals like the following three:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x <span class="sc">&lt;=</span> <span class="fl">68.5</span>) <span class="sc">-</span> <span class="fu">mean</span>(x <span class="sc">&lt;=</span> <span class="fl">67.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.114532</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x <span class="sc">&lt;=</span> <span class="fl">69.5</span>) <span class="sc">-</span> <span class="fu">mean</span>(x <span class="sc">&lt;=</span> <span class="fl">68.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1194581</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x <span class="sc">&lt;=</span> <span class="fl">70.5</span>) <span class="sc">-</span> <span class="fu">mean</span>(x <span class="sc">&lt;=</span> <span class="fl">69.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1219212</code></pre>
</div>
</div>
<p>Note how close we get with the normal approximation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">68.5</span>, m, s) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">67.5</span>, m, s) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1031077</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">69.5</span>, m, s) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">68.5</span>, m, s) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1097121</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">70.5</span>, m, s) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">69.5</span>, m, s) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1081743</code></pre>
</div>
</div>
<p>However, the approximation is not as useful for other intervals. For instance, notice how the approximation breaks down when we try to estimate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x <span class="sc">&lt;=</span> <span class="fl">70.9</span>) <span class="sc">-</span> <span class="fu">mean</span>(x<span class="sc">&lt;=</span><span class="fl">70.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02216749</code></pre>
</div>
</div>
<p>with</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">70.9</span>, m, s) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">70.1</span>, m, s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08359562</code></pre>
</div>
</div>
<p>In general, we call this situation <em>discretization</em>. Although the true height distribution is continuous, the reported heights tend to be more common at discrete values, in this case, due to rounding. As long as we are aware of how to deal with this reality, the normal approximation can still be a very useful tool.</p>
</section>
<section id="the-probability-density" class="level3" data-number="7.27.2">
<h3 data-number="7.27.2" class="anchored" data-anchor-id="the-probability-density"><span class="header-section-number">7.27.2</span> The probability density</h3>
<p>For categorical distributions, we can define the probability of a category. For example, a roll of a die, let’s call it <span class="math inline">\(X\)</span>, can be 1,2,3,4,5 or 6. The probability of 4 is defined as:</p>
<p><span class="math display">\[
\mbox{Pr}(X=4) = 1/6
\]</span></p>
<p>The CDF can then easily be defined: <span class="math display">\[
F(4) = \mbox{Pr}(X\leq 4) =  \mbox{Pr}(X = 4) +  \mbox{Pr}(X = 3) +  \mbox{Pr}(X = 2) +  \mbox{Pr}(X = 1)
\]</span></p>
<p>Although for continuous distributions the probability of a single value <span class="math inline">\(\mbox{Pr}(X=x)\)</span> is not defined, there is a theoretical definition that has a similar interpretation. The probability density at <span class="math inline">\(x\)</span> is defined as the function <span class="math inline">\(f(a)\)</span> such that:</p>
<p><span class="math display">\[
F(a) = \mbox{Pr}(X\leq a) = \int_{-\infty}^a f(x)\, dx
\]</span></p>
<p>For those that know calculus, remember that the integral is related to a sum: it is the sum of bars with widths approximating 0. If you don’t know calculus, you can think of <span class="math inline">\(f(x)\)</span> as a curve for which the area under that curve up to the value <span class="math inline">\(a\)</span>, gives you the probability <span class="math inline">\(\mbox{Pr}(X\leq a)\)</span>.</p>
<p>For example, to use the normal approximation to estimate the probability of someone being taller than 76 inches, we use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">76</span>, m, s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03206008</code></pre>
</div>
</div>
<p>which mathematically is the grey area below:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="probability_files/figure-html/intergrals-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The curve you see is the probability density for the normal distribution. In R, we get this using the function <code>dnorm</code>.</p>
<p>Although it may not be immediately obvious why knowing about probability densities is useful, understanding this concept will be essential to those wanting to fit models to data for which predefined functions are not available.</p>
</section>
</section>
<section id="monte-carlo-simulations-for-continuous-variables" class="level2" data-number="7.28">
<h2 data-number="7.28" class="anchored" data-anchor-id="monte-carlo-simulations-for-continuous-variables"><span class="header-section-number">7.28</span> Monte Carlo simulations for continuous variables</h2>
<p>R provides functions to generate normally distributed outcomes. Specifically, the <code>rnorm</code> function takes three arguments: size, average (defaults to 0), and standard deviation (defaults to 1) and produces random numbers. Here is an example of how we could generate data that looks like our reported heights:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>simulated_heights <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, m, s)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Not surprisingly, the distribution looks normal:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="probability_files/figure-html/simulated-heights-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is one of the most useful functions in R as it will permit us to generate data that mimics natural events and answers questions related to what could happen by chance by running Monte Carlo simulations.</p>
<p>If, for example, we pick 800 males at random, what is the distribution of the tallest person? How rare is a seven footer in a group of 800 males? The following Monte Carlo simulation helps us answer that question:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>tallest <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  simulated_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">800</span>, m, s)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(simulated_data)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Having a seven footer is quite rare:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(tallest <span class="sc">&gt;=</span> <span class="dv">7</span><span class="sc">*</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0172</code></pre>
</div>
</div>
<p>Here is the resulting distribution:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="probability_files/figure-html/simulated-tallest-height-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that it does not look normal.</p>
</section>
<section id="continuous-distributions" class="level2" data-number="7.29">
<h2 data-number="7.29" class="anchored" data-anchor-id="continuous-distributions"><span class="header-section-number">7.29</span> Continuous distributions</h2>
<p>We introduced the normal distribution in Section @ref(normal-distribution) and used it as an example above. The normal distribution is not the only useful theoretical distribution. Other continuous distributions that we may encounter are the student-t, Chi-square, exponential, gamma, beta, and beta-binomial. R provides functions to compute the density, the quantiles, the cumulative distribution functions and to generate Monte Carlo simulations. R uses a convention that lets us remember the names, namely using the letters <code>d</code>, <code>q</code>, <code>p</code>, and <code>r</code> in front of a shorthand for the distribution. We have already seen the functions <code>dnorm</code>, <code>pnorm</code>, and <code>rnorm</code> for the normal distribution. The functions <code>qnorm</code> gives us the quantiles. We can therefore draw a distribution like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(x, f, <span class="at">geom =</span> <span class="st">"line"</span>, <span class="at">data =</span> <span class="fu">data.frame</span>(x, <span class="at">f =</span> <span class="fu">dnorm</span>(x)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the student-t, described later in Section @ref(t-dist), the shorthand <code>t</code> is used so the functions are <code>dt</code> for the density, <code>qt</code> for the quantiles, <code>pt</code> for the cumulative distribution function, and <code>rt</code> for Monte Carlo simulation.</p>
</section>
<section id="exercises-1" class="level2" data-number="7.30">
<h2 data-number="7.30" class="anchored" data-anchor-id="exercises-1"><span class="header-section-number">7.30</span> Exercises</h2>
<p>1. Assume the distribution of female heights is approximated by a normal distribution with a mean of 64 inches and a standard deviation of 3 inches. If we pick a female at random, what is the probability that she is 5 feet or shorter?</p>
<p>2. Assume the distribution of female heights is approximated by a normal distribution with a mean of 64 inches and a standard deviation of 3 inches. If we pick a female at random, what is the probability that she is 6 feet or taller?</p>
<p>3. Assume the distribution of female heights is approximated by a normal distribution with a mean of 64 inches and a standard deviation of 3 inches. If we pick a female at random, what is the probability that she is between 61 and 67 inches?</p>
<p>4. Repeat the exercise above, but convert everything to centimeters. That is, multiply every height, including the standard deviation, by 2.54. What is the answer now?</p>
<p>5. Notice that the answer to the question does not change when you change units. This makes sense since the answer to the question should not be affected by what units we use. In fact, if you look closely, you notice that 61 and 64 are both 1 SD away from the average. Compute the probability that a randomly picked, normally distributed random variable is within 1 SD from the average.</p>
<p>6. To see the math that explains why the answers to questions 3, 4, and 5 are the same, suppose we have a random variable with average <span class="math inline">\(m\)</span> and standard error <span class="math inline">\(s\)</span>. Suppose we ask the probability of <span class="math inline">\(X\)</span> being smaller or equal to <span class="math inline">\(a\)</span>. Remember that, by definition, <span class="math inline">\(a\)</span> is <span class="math inline">\((a - m)/s\)</span> standard deviations <span class="math inline">\(s\)</span> away from the average <span class="math inline">\(m\)</span>. The probability is:</p>
<p><span class="math display">\[
\mbox{Pr}(X \leq a)
\]</span></p>
<p>Now we subtract <span class="math inline">\(\mu\)</span> to both sides and then divide both sides by <span class="math inline">\(\sigma\)</span>:</p>
<p><span class="math display">\[
\mbox{Pr}\left(\frac{X-m}{s} \leq \frac{a-m}{s} \right)
\]</span></p>
<p>The quantity on the left is a standard normal random variable. It has an average of 0 and a standard error of 1. We will call it <span class="math inline">\(Z\)</span>:</p>
<p><span class="math display">\[
\mbox{Pr}\left(Z \leq \frac{a-m}{s} \right)
\]</span></p>
<p>So, no matter the units, the probability of <span class="math inline">\(X\leq a\)</span> is the same as the probability of a standard normal variable being less than <span class="math inline">\((a - m)/s\)</span>. If <code>mu</code> is the average and <code>sigma</code> the standard error, which of the following R code would give us the right answer in every situation:</p>
<ol type="a">
<li><code>mean(X&lt;=a)</code></li>
<li><code>pnorm((a - m)/s)</code></li>
<li><code>pnorm((a - m)/s, m, s)</code></li>
<li><code>pnorm(a)</code></li>
</ol>
<p>7. Imagine the distribution of male adults is approximately normal with an expected value of 69 and a standard deviation of 3. How tall is the male in the 99th percentile? Hint: use <code>qnorm</code>.</p>
<p>8. The distribution of IQ scores is approximately normally distributed. The average is 100 and the standard deviation is 15. Suppose you want to know the distribution of the highest IQ across all graduating classes if 10,000 people are born each in your school district. Run a Monte Carlo simulation with <code>B=1000</code> generating 10,000 IQ scores and keeping the highest. Make a histogram.</p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>https://en.wikipedia.org/wiki/Urn_problem<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>https://www.khanacademy.org/math/precalculus/prob-comb/dependent-events-precalc/v/monty-hall-problem<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>https://en.wikipedia.org/wiki/Monty_Hall_problem<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Git_GitHub.html" class="pagination-link" aria-label="Git and GitHub">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Git and GitHub</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./summary.html" class="pagination-link" aria-label="Summary">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Summary</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>